#include <stdio.h>
#include <math.h>
int gcd(int a, int b) {
    if (b == 0) return a;
    return gcd(b, a % b);
}

int main() {
    double p, q, n, phi, e, d = 0;
    double msg, c, m;
    int i;

    printf("Enter two prime numbers p and q: ");
    scanf("%lf %lf", &p, &q);

    n = p * q;
    phi = (p - 1) * (q - 1);
    for (e = 2; e < phi; e++)
        if (gcd(e, (int)phi) == 1)
            break;
    for (i = 1; i < 10; i++) {
        double x = 1 + (i * phi);
        if (fmod(x, e) == 0) {
            d = x / e;
            break;
        }
    }

    printf("\nPublic Key: (%.0lf, %.0lf)", e, n);
    printf("\nPrivate Key: (%.0lf, %.0lf)", d, n);

    printf("\n\nEnter message (number): ");
    scanf("%lf", &msg);
    c = fmod(pow(msg, e), n);
    printf("Encrypted message: %.0lf", c);
    m = fmod(pow(c, d), n);
    printf("\nDecrypted message: %.0lf\n", m);

    return 0;
}
